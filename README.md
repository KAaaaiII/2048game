[toc]

# C++课程设计项目报告：2048小游戏

> 使用集成开发环境为Visual Studio 2022社区版，C++编写 

>  项目小组成员：
> 机械类2301班 伍轩熠  U202310606
> 机械类2301班 江嘉桐
> 机械类2301班 王梓帆

## 一、小组分工

## 二、游戏规则

2048作为一个经久不衰的小游戏，游戏规则较为基础

1. 初始地图为一个**4\*4**的网格，每一个网格均为空
2. 开始游戏后，每轮随机在一个空网格内生成一个数字**2**
3. 玩家有四种操作，分别为上移、下移、左移、右移
4. 每次操作，地图中所有数字都会向所选方向移动，补足该方向一侧的空格
5. 当该方向相邻两格中数字相同，两数字合成为原数字数值的两倍，每个数字每轮仅合并一次
6. 每次合并，玩家获得合并后数值的分数
7. 胜利条件：成功合成出2048($10^{11}$)，玩家获胜
8. 游戏结束条件：玩家成功合成2048，或所有网格被数字填满，无法再移动，游戏结束，玩家失败

## 三、游戏界面设计

由于时间比较紧张，并未使用easyx等图形库，主要通过控制台输出

1. 标题“2048 game”
2. 玩家得分、用户名
3. 游戏主界面，包含一个**4\*4**的网格，通过for循环输出‘|’与‘-’构建。数据结构是一个二维数组``Map[i][j]``，储存每格中的数值

```c++
for (int i = 1; i <= 5 * N + 1; i++)cout << '-';
		cout << endl;
		for (int i = 1; i <= N; i++) {
			cout << " ";
			cout << '|';
			for (int j = 1; j <= N; j++) {
				if (Map[i][j]) {
					cout << setw(4) << Map[i][j];
					cout << '|';
				}
				else cout << setw(5) << '|';
			}
			cout << endl;
			cout << "  ";
			for (int i = 1; i <= N * 5 + 1; i++) cout << '-';
			cout << endl;
```

4. 为了更好的游戏体验，我们采用了windows.h库内部的光标操作，隐藏了控制台的光标，hideCursor函数如下：

``` c++
void hideCursor() {//隐藏光标操作，这里参考了一些网上的做法
	CONSOLE_CURSOR_INFO cursor;
	cursor.bVisible = 0;
	cursor.dwSize = 1;
	HANDLE hOut = GetStdHandle(STD_OUTPUT_HANDLE);
	SetConsoleCursorInfo(hOut, &cursor);
}
```

## 四、程序设计

### （一）数据结构设计

### （二）程序流程设计

### （三）交互方式设计

## 五、系统实现

### （一）初始化函数initialize

### （二）游戏运行函数run

### （三）操作函数up、down、left、right

### （四）检验函数over

## 六、测试与结果展示

### 1.初始界面

### 2.游玩界面

### 3.结束界面

#### 胜利界面

#### 失败界面

